<h1>Histórico das Avaliações</h1>

<div *ngIf="isAuthorized">
  <select class="form-select" name="selectUsuario" id="select-usuario" #usuarioSelect (change)="getHistoricoAvaliacoes(usuarioSelect.value)">
    <option disabled selected value="">Selecione um Funcionário</option>
    <option *ngFor="let user of filteredUsers" [value]="user.name">{{ user.name }}</option>
  </select>
</div>

<p class="aviso-ultimas"><strong>Últimas avaliações realizadas:</strong></p>
<div class="wrapper-historico">
  <div class="avaliacao" *ngFor="let avaliacao of historicoAvaliacoes">

    <div class="data-avaliacao">
      <p><svg width="12" height="14" viewBox="0 0 12 14" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M1.33333 13.5C0.966667 13.5 0.652778 13.3727 0.391667 13.1181C0.130556 12.8635 0 12.5575 0 12.2V3.1C0 2.7425 0.130556 2.43646 0.391667 2.18187C0.652778 1.92729 0.966667 1.8 1.33333 1.8H2V0.5H3.33333V1.8H8.66667V0.5H10V1.8H10.6667C11.0333 1.8 11.3472 1.92729 11.6083 2.18187C11.8694 2.43646 12 2.7425 12 3.1V12.2C12 12.5575 11.8694 12.8635 11.6083 13.1181C11.3472 13.3727 11.0333 13.5 10.6667 13.5H1.33333ZM1.33333 12.2H10.6667V5.7H1.33333V12.2Z" fill="#666666"/>
        </svg>{{ avaliacao.dataFormatada }}
        </p>
    </div>

    <div class="autor-avaliacao">
      <p><span>Avaliado por:</span> {{ avaliacao.avaliador }}</p>
    </div>

    <div class="nota-individual">
      <div class="nota-numeral">
        <p><span>Nota Individual:</span> {{ avaliacao.mediaIndividual | number:'1.2-2' }}</p>
      </div>
      <div class="nota-nivel">
        <p>
          <span class="performance-prata" *ngIf="avaliacao.mediaIndividual < 8">
              <svg width="20" height="15" viewBox="0 0 20 15" fill="none" xmlns="http://www.w3.org/2000/svg">
              <g clip-path="url(#clip0_31_142)">
              <path d="M17.7954 12.4219L17.4473 13.9863C17.3761 14.3055 17.1019 14.5312 16.7857 14.5312H3.21427C2.89806 14.5312 2.62392 14.3055 2.55267 13.9863L2.20456 12.4219H17.7954Z" fill="#1C1C1C"/>
              <path d="M19.483 4.84567L18.1089 11.0156H1.89106L0.516952 4.84567C0.456559 4.57356 0.556988 4.28949 0.773452 4.12285C0.990595 3.95621 1.2817 3.93863 1.51513 4.07715L5.71481 6.5641L9.43474 0.782306C9.5562 0.593869 9.75706 0.47715 9.97488 0.468712C10.1947 0.458869 10.4017 0.561525 10.5354 0.740119L14.8979 6.55215L18.4448 4.10246C18.6762 3.94356 18.9782 3.94496 19.2068 4.10879C19.4362 4.27262 19.5448 4.56512 19.483 4.84567Z" fill="#1C1C1C"/>
              </g>
              <defs>
              <clipPath id="clip0_31_142">
              <rect width="19" height="15" fill="white" transform="translate(0.5)"/>
              </clipPath>
              </defs>
              </svg>
              Prata
          </span>
          <span class="performance-ouro" *ngIf="avaliacao.mediaIndividual >= 8 && avaliacao.mediaIndividual < 9"><svg width="20" height="15" viewBox="0 0 20 15" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_31_142)">
            <path d="M17.7954 12.4219L17.4473 13.9863C17.3761 14.3055 17.1019 14.5312 16.7857 14.5312H3.21427C2.89806 14.5312 2.62392 14.3055 2.55267 13.9863L2.20456 12.4219H17.7954Z" fill="#1C1C1C"/>
            <path d="M19.483 4.84567L18.1089 11.0156H1.89106L0.516952 4.84567C0.456559 4.57356 0.556988 4.28949 0.773452 4.12285C0.990595 3.95621 1.2817 3.93863 1.51513 4.07715L5.71481 6.5641L9.43474 0.782306C9.5562 0.593869 9.75706 0.47715 9.97488 0.468712C10.1947 0.458869 10.4017 0.561525 10.5354 0.740119L14.8979 6.55215L18.4448 4.10246C18.6762 3.94356 18.9782 3.94496 19.2068 4.10879C19.4362 4.27262 19.5448 4.56512 19.483 4.84567Z" fill="#1C1C1C"/>
            </g>
            <defs>
            <clipPath id="clip0_31_142">
            <rect width="19" height="15" fill="white" transform="translate(0.5)"/>
            </clipPath>
            </defs>
            </svg>
            Ouro
          </span>
          <span class="performance-diamante" *ngIf="avaliacao.mediaIndividual >= 9">
            <svg width="20" height="15" viewBox="0 0 20 15" fill="none" xmlns="http://www.w3.org/2000/svg">
              <g clip-path="url(#clip0_31_142)">
              <path d="M17.7954 12.4219L17.4473 13.9863C17.3761 14.3055 17.1019 14.5312 16.7857 14.5312H3.21427C2.89806 14.5312 2.62392 14.3055 2.55267 13.9863L2.20456 12.4219H17.7954Z" fill="#1C1C1C"/>
              <path d="M19.483 4.84567L18.1089 11.0156H1.89106L0.516952 4.84567C0.456559 4.57356 0.556988 4.28949 0.773452 4.12285C0.990595 3.95621 1.2817 3.93863 1.51513 4.07715L5.71481 6.5641L9.43474 0.782306C9.5562 0.593869 9.75706 0.47715 9.97488 0.468712C10.1947 0.458869 10.4017 0.561525 10.5354 0.740119L14.8979 6.55215L18.4448 4.10246C18.6762 3.94356 18.9782 3.94496 19.2068 4.10879C19.4362 4.27262 19.5448 4.56512 19.483 4.84567Z" fill="#1C1C1C"/>
              </g>
              <defs>
              <clipPath id="clip0_31_142">
              <rect width="19" height="15" fill="white" transform="translate(0.5)"/>
              </clipPath>
              </defs>
              </svg>
              Diamante
            </span>
        </p>
      </div>
    </div>

    <p><span>Nota do Time:</span> {{ avaliacao.mediaTime | number:'1.2-2' }}</p>
    <p><span>Nota da Empresa:</span> {{ avaliacao.mediaEmpresa | number:'1.2-2' }}</p>
    <p><span>Absenteísmo: </span> <span class="absenteismo">{{ getAbsenteismo(avaliacao) }}</span></p>

    <hr>

    <div class="media-final">
      <p class="nota-final"><span class="titulo-media-final">Média Final:</span><span class="nota-media-final">{{ avaliacao.mediaFinalGeral | number:'1.2-2' }}</span></p>
    </div>
    <div>
      <ul>
        <li *ngFor="let item of avaliacao.itens">
          {{ item.nome }}: {{ item.nota }}
        </li>
      </ul>

      <div class="download-relatorio">
        <button  (click)="downloadRelatorio(avaliacao)"> <svg width="13" height="12" viewBox="0 0 13 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6.50004 8.83331L2.95837 5.29165L3.95004 4.26456L5.79171 6.10623V0.333313H7.20837V6.10623L9.05004 4.26456L10.0417 5.29165L6.50004 8.83331ZM2.25004 11.6666C1.86046 11.6666 1.52695 11.5279 1.24952 11.2505C0.972089 10.9731 0.833374 10.6396 0.833374 10.25V8.12498H2.25004V10.25H10.75V8.12498H12.1667V10.25C12.1667 10.6396 12.028 10.9731 11.7506 11.2505C11.4731 11.5279 11.1396 11.6666 10.75 11.6666H2.25004Z" fill="#1C1B1F"/>
          </svg>
          Baixar Relatório
        </button>
      </div>
    </div>
  </div>
</div>

<div class="wrapper-performance">
  <div class="performance-flex" *ngIf="historicoAvaliacoes && historicoAvaliacoes.length >= 4">

    <div *ngIf="aptoPromocao; else notApto">
      <div class="resultado-apto promocao">
        <div class="icone-promocao">
          <svg width="22" height="21" viewBox="0 0 22 21" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M7.6 21L5.7 17.8L2.1 17L2.45 13.3L0 10.5L2.45 7.7L2.1 4L5.7 3.2L7.6 0L11 1.45L14.4 0L16.3 3.2L19.9 4L19.55 7.7L22 10.5L19.55 13.3L19.9 17L16.3 17.8L14.4 21L11 19.55L7.6 21ZM9.95 14.05L15.6 8.4L14.2 6.95L9.95 11.2L7.8 9.1L6.4 10.5L9.95 14.05Z" fill="#00175D"/>
          </svg>            
        </div>
        <div class="texto-promocao">
          <p>Apto para <strong>promoção</strong></p>
          <p><span>Saiba mais
            <div class="tooltip-promocao">
              <p>Para um funcionairuz estar apto à uma promoção, é necessário ter passado por 4 (quatro) <strong>avaliações diamante</strong> consecutivas. Para mais informações, consulte nosso <a href="https://d335luupugsy2.cloudfront.net/cms%2Ffiles%2F42350%2F1712154011Nairuz_Plano_de_Carreira_2024_1.pdf?utm_campaign=avaliacao_de_desempenho_-_abril24&utm_medium=email&utm_source=RD+Station">Plano de Carreira</a>.</p>
            </div>
          </span></p>
        </div>

      </div>
    </div>
    <ng-template #notApto>
      
      <div class="resultado-nao-apto promocao">
        <div class="icone-promocao">
          <svg width="20" height="21" viewBox="0 0 20 21" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9 15.5H11V9.5H9V15.5ZM10 7.5C10.2833 7.5 10.5208 7.40417 10.7125 7.2125C10.9042 7.02083 11 6.78333 11 6.5C11 6.21667 10.9042 5.97917 10.7125 5.7875C10.5208 5.59583 10.2833 5.5 10 5.5C9.71667 5.5 9.47917 5.59583 9.2875 5.7875C9.09583 5.97917 9 6.21667 9 6.5C9 6.78333 9.09583 7.02083 9.2875 7.2125C9.47917 7.40417 9.71667 7.5 10 7.5ZM10 20.5C8.61667 20.5 7.31667 20.2375 6.1 19.7125C4.88333 19.1875 3.825 18.475 2.925 17.575C2.025 16.675 1.3125 15.6167 0.7875 14.4C0.2625 13.1833 0 11.8833 0 10.5C0 9.11667 0.2625 7.81667 0.7875 6.6C1.3125 5.38333 2.025 4.325 2.925 3.425C3.825 2.525 4.88333 1.8125 6.1 1.2875C7.31667 0.7625 8.61667 0.5 10 0.5C11.3833 0.5 12.6833 0.7625 13.9 1.2875C15.1167 1.8125 16.175 2.525 17.075 3.425C17.975 4.325 18.6875 5.38333 19.2125 6.6C19.7375 7.81667 20 9.11667 20 10.5C20 11.8833 19.7375 13.1833 19.2125 14.4C18.6875 15.6167 17.975 16.675 17.075 17.575C16.175 18.475 15.1167 19.1875 13.9 19.7125C12.6833 20.2375 11.3833 20.5 10 20.5Z" fill="#1C1B1F"/>
          </svg>                       
        </div>
        <div class="texto-promocao">
          <p>Não apto para <strong>promoção</strong></p>
          <p><span>Saiba mais
            <div class="tooltip-promocao">
              <p>Para um funcionairuz estar apto à uma promoção, é necessário ter passado por 4 (quatro) <strong>avaliações diamante</strong> consecutivas. Para mais informações, consulte nosso <a href="https://d335luupugsy2.cloudfront.net/cms%2Ffiles%2F42350%2F1712154011Nairuz_Plano_de_Carreira_2024_1.pdf?utm_campaign=avaliacao_de_desempenho_-_abril24&utm_medium=email&utm_source=RD+Station">Plano de Carreira</a>.</p>
            </div>
          </span></p>
        </div>
      </div>

    </ng-template>

    <div *ngIf="verificarAptoBonificacao() as resultado">
      <div *ngIf="resultado.apto; else notAptoBonificacao">
        <div class="resultado-apto bonificacao">
          <div class="icone-bonificacao">
            <svg width="22" height="21" viewBox="0 0 22 21" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M7.6 21L5.7 17.8L2.1 17L2.45 13.3L0 10.5L2.45 7.7L2.1 4L5.7 3.2L7.6 0L11 1.45L14.4 0L16.3 3.2L19.9 4L19.55 7.7L22 10.5L19.55 13.3L19.9 17L16.3 17.8L14.4 21L11 19.55L7.6 21ZM9.95 14.05L15.6 8.4L14.2 6.95L9.95 11.2L7.8 9.1L6.4 10.5L9.95 14.05Z" fill="#00175D"/>
            </svg> 
          </div>
          <div class="texto-bonificacao">
            <p>Apto para <strong>bonificação - {{ resultado.nivel }}</strong></p>
            <p><span>Saiba mais
              <div class="tooltip-bonificacao">
                <p>Para um funcionairuz estar apto
                  à uma bonificação, é necessário
                  ter passado por 2 (duas) avaliações ouro ou diamante consecutivas, e apresentar absenteísmo Bom ou Muito Bom. Para mais informações, consulte nosso <a href="https://d335luupugsy2.cloudfront.net/cms%2Ffiles%2F42350%2F1712154011Nairuz_Plano_de_Carreira_2024_1.pdf?utm_campaign=avaliacao_de_desempenho_-_abril24&utm_medium=email&utm_source=RD+Station">Plano de Carreira</a>.</p>
              </div>
            </span></p>
          </div>
        </div>
      </div>
    </div>
    <ng-template #notAptoBonificacao>
      <div class="resultado-nao-apto bonificacao">
        <div class="icone-bonificacao">
          <svg width="20" height="21" viewBox="0 0 20 21" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9 15.5H11V9.5H9V15.5ZM10 7.5C10.2833 7.5 10.5208 7.40417 10.7125 7.2125C10.9042 7.02083 11 6.78333 11 6.5C11 6.21667 10.9042 5.97917 10.7125 5.7875C10.5208 5.59583 10.2833 5.5 10 5.5C9.71667 5.5 9.47917 5.59583 9.2875 5.7875C9.09583 5.97917 9 6.21667 9 6.5C9 6.78333 9.09583 7.02083 9.2875 7.2125C9.47917 7.40417 9.71667 7.5 10 7.5ZM10 20.5C8.61667 20.5 7.31667 20.2375 6.1 19.7125C4.88333 19.1875 3.825 18.475 2.925 17.575C2.025 16.675 1.3125 15.6167 0.7875 14.4C0.2625 13.1833 0 11.8833 0 10.5C0 9.11667 0.2625 7.81667 0.7875 6.6C1.3125 5.38333 2.025 4.325 2.925 3.425C3.825 2.525 4.88333 1.8125 6.1 1.2875C7.31667 0.7625 8.61667 0.5 10 0.5C11.3833 0.5 12.6833 0.7625 13.9 1.2875C15.1167 1.8125 16.175 2.525 17.075 3.425C17.975 4.325 18.6875 5.38333 19.2125 6.6C19.7375 7.81667 20 9.11667 20 10.5C20 11.8833 19.7375 13.1833 19.2125 14.4C18.6875 15.6167 17.975 16.675 17.075 17.575C16.175 18.475 15.1167 19.1875 13.9 19.7125C12.6833 20.2375 11.3833 20.5 10 20.5Z" fill="#1C1B1F"/>
          </svg>  
        </div>
        <div class="texto-bonificacao">
          <p>Não apto para <strong>bonificação</strong></p>
          <p><span>Saiba mais
            <div class="tooltip-bonificacao">
              <p>Para um funcionairuz estar apto
                à uma bonificação, é necessário
                ter passado por 2 (duas) avaliações ouro ou diamante consecutivas, e apresentar absenteísmo Bom ou Muito Bom. Para mais informações, consulte nosso <a href="https://d335luupugsy2.cloudfront.net/cms%2Ffiles%2F42350%2F1712154011Nairuz_Plano_de_Carreira_2024_1.pdf?utm_campaign=avaliacao_de_desempenho_-_abril24&utm_medium=email&utm_source=RD+Station">Plano de Carreira</a>.</p>
            </div>
          </span></p>
        </div>
      </div>
    </ng-template>


  </div>
  <div *ngIf="historicoAvaliacoes && historicoAvaliacoes.length < 4">
    <p>É necessário pelo menos 4 avaliações para avaliar o nível do funcionairuz.</p>
  </div>
</div>


